%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%% Full Results %%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

pca = [99.40161591946304; 102.32140359146561; 111.00051257579567; 99.429487164860987; 96.115069274303039; 97.617553138613005; 105.42397378322198; 107.54465306763259; 100.92588722668012; 102.42915278686125; 100.65084278817854; 105.99619499191802; 97.286287509860699; 110.35965275665149; 97.206143015112843; 102.5893370456991; 97.927004323236446; 103.15167859085612; 98.946074963929547; 100.13537093330783; 100.61529742528218; 101.75849900675581; 102.48781568699187; 102.39249855758409; 101.77686389397603; 96.635394830089737; 105.52709970363014; 102.94084098239813; 99.943283508831669; 100.97779318142724; 110.3892518851805; 95.824233064052549; 105.32817428358645; 98.531436717238606; 99.961377305119058; 102.83942175736671; 106.3308166857902; 100.33262019948447; 101.94067758277573; 101.82176939212151];
cmeans = [13.566896723256505; 16.68959997271568; 26.211375189369488; 20.423768489962409; 23.430453787404502; 8.3586998644455548; 17.092293180747124; 19.424369265806774; 18.203498532086449; 20.688477134315502; 19.014366396540407; 22.326513602721377; 10.245208872768403; 26.651841721269257; 25.773888299816097; 29.269772144069098; 17.860944396250744; 20.160286407333963; 16.863447351229471; 16.6683450288145; 16.951706595899179; 17.482901901478826; 36.223778054297597; 16.825749465260017; 8.6747482364822357; 19.386915453481212; 25.838081608633839; 20.596044326713837; 15.366740601979757; 16.699826920321943; 27.878806408262417; 20.426142467860984; 25.542709012110326; 13.345601711513964; 22.183195145468854; 20.296406422469598; 28.17550140343333; 22.794912925372056; 27.691337482187905; 18.08835374993614];
aa = [9.1177869890113801; 30.241562004188847; 33.659941993149751; 26.011535081955966; 20.91973692338356; 29.562068369198826; 30.276304117568863; 20.620737300444361; 21.445313580662098; 21.369811627654705; 17.502178149624591; 26.669629877991053; 12.781423112628509; 26.438817472912994; 25.517887115935672; 23.28754868470179; 27.425028147034755; 25.040917124422368; 16.886531441745667; 20.326575002654796; 20.819031928461797; 18.641443926643632; 42.459245671552161; 18.055694314594863; 14.6386201290405; 25.102131796041565; 26.210828128688362; 23.912646737635281; 24.939608290174426; 16.727680270278224; 28.183898012888008; 22.022323532495022; 27.835468996561559; 21.875890067432348; 9.7262542621323416; 16.837251759904827; 26.883494194462525; 22.886870741913274; 27.959670108680573; 20.491788094147164];

data(:,1) = pca';
data(:,2) = cmeans';
data(:,3) = aa';

[p, table, stats] = anova1(data);
% Source       SS      df      MS         F         Prob>F
% -----------------------------------------------------------
% Columns   171833.9     2   85916.9   2915.39   1.54579e-100
% Error       3448     117      29.5
% Total     175281.9   119

% There was a statistically significant difference between groups as determined by one-way ANOVA ($F(2, 117) = 2915.39, p = 1.54579 x 10^{-100}$).

[c, m, h, nms] = multcompare(stats, 'ctype', 'hsd');
% 2 and 3 aren't significantly different, but the others are.

errs = [pca ones(40,1);
cmeans ones(40,1)+1;
aa ones(40,1)+2];

GHtest(errs)

% Table of the difference between each pair of means in terms of the Tukey's
% statistic and then comparing them with its critical value.
% ------------------------------------------------------------------------
%  Comparison            D               q              df'    Conclusion
% ------------------------------------------------------------------------
%     3  2             2.7979          2.0575           77          NS
%     3  1            78.8375         67.2357           63          S
%     2  1            81.6355         74.6338           67          S
% ------------------------------------------------------------------------
% With a given significance level of: 0.0500
% The results are significant (S) and/or not significant (NS).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%% Missing Data %%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

pcaMiss = [110.14978523875888; 109.82742737003611; 111.00051866553464; 99.429487164860987; 122.36793083963779; 117.12987851002647; 139.21343628208362; 107.54465306763259; 116.13786565271123; 102.42915278686125; 100.65084278817854; 105.99619499191802; 97.286287509860699; 110.35965275665149; 97.206139187607505; 111.52717469204346; 108.48516121759182; 136.85449491917976; 98.946074963929547; 100.13537093330783; 100.61529742528218; 101.75849900675581; 102.48781568699187; 102.39249855758409; 101.77686389397603; 96.635395604075597; 105.52709970363014; 102.94084782040979; 99.943283508831669; 100.97779318142724; 110.3892518851805; 95.824233064052549; 143.5081019770509; 98.531436717238606; 99.961377305119058; 125.1301753793872; 106.3308166857902; 100.33262019948447; 101.94067758277573; 137.46771191611455];
cmeansMiss = [46.704123829552984; 41.663179291796837; 26.211376522226651; 20.423768489962409; 75.125133524474364; 61.481928706796253; 87.313076290018017; 19.424369265806774; 57.096292590521621; 20.688477134315502; 19.014366396540407; 22.326513602721377; 10.245208872768403; 26.651841721269257; 25.773902014391858; 50.412455828405569; 47.494396797437226; 89.408731378241029; 16.863447351229471; 16.6683450288145; 16.951706595899179; 17.482901901478826; 36.223778054297597; 16.825749465260017; 8.6747482364822357; 19.386908445283815; 25.838081608633839; 20.596048420630051; 15.366740601979757; 16.699826920321943; 27.878806408262417; 20.426142467860984; 97.672790844882357; 13.345601711513964; 22.183195145468854; 70.145367506197346; 28.17550140343333; 22.794912925372056; 27.691337482187905; 88.850093404684088];
aaMiss = [46.94589181422878; 49.52960994950034; 33.660058753538408; 26.011535081956112; 76.512705725024944; 69.682964526908606; 93.218779210621705; 20.620737300444645; 59.729597624079972; 21.369811627654911; 17.502178149624537; 26.669629877991277; 12.781423112628213; 26.438817472912298; 25.517969165465612; 48.338532983529383; 52.859068277213275; 92.075710968656651; 16.886531441744911; 20.326575002654252; 20.819031928461612; 18.641443926643522; 42.459245671551365; 18.05569431459481; 14.638620129041177; 25.102020259772932; 26.210828128688394; 23.912575559594067; 24.939608290174302; 16.72768027027842; 28.183898012887955; 22.022323532494866; 99.796570694724053; 21.87589006743276; 9.7262542621323185; 71.218686000792275; 26.88349419446261; 22.88687074191315; 27.959670108680044; 92.074729235908109];

dataMiss(:,1) = pcaMiss';
dataMiss(:,2) = cmeansMiss';
dataMiss(:,3) = aaMiss';

[p, table, statsMiss] = anova1(dataMiss);
% Source       SS      df      MS        F        Prob>F
% ---------------------------------------------------------
% Columns   139765.9     2   69882.9   149.48   5.95601e-33
% Error      54700.1   117     467.5
% Total     194466     119

% There was a statistically significant difference between groups as determined by one-way ANOVA ($F(2, 117) = 149.48, p = 5.95601 x 10^{-33}$).
% The assumption of homogeneity of variances has clearly been violated because of the many outliers, so the Games Howell post hoc test will be used to determine if the difference between errors is statistically significant.

[c, m, h, nms] = multcompare(statsMiss, 'ctype', 'hsd');
% 2 and 3 aren't significantly different, but the others are.

errsMiss = [pca ones(40,1);
cmeans ones(40,1)+1;
aa ones(40,1)+2];

GHtest(errs)

% Table of the difference between each pair of means in terms of the Tukey's
% statistic and then comparing them with its critical value.
% ------------------------------------------------------------------------
%  Comparison            D               q              df'    Conclusion
% ------------------------------------------------------------------------
%     3  2             2.7979          2.0575           77          NS
%     3  1            78.8375         67.2357           63          S
%     2  1            81.6355         74.6338           67          S
% ------------------------------------------------------------------------
% With a given significance level of: 0.0500
% The results are significant (S) and/or not significant (NS).
